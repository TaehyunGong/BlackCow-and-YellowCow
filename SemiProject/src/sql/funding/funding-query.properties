mainSelect=SELECT ROWNUM, RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT , QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS FROM( SELECT ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, PR.PROGRESS FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO) WHERE P.PRODUCT_TYPE IS NULL AND A.FILE_TYPE='F2' AND P.STATUS = 'Y') ORDER BY RANKS DESC)WHERE ROWNUM <= 4
mainSelectFood=SELECT ROWNUM, RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT , QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS FROM( SELECT ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS  FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, PR.PROGRESS  FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO) WHERE P.PRODUCT_TYPE IS NOT NULL AND A.FILE_TYPE='F2' AND P.STATUS = 'Y') ORDER BY RANKS DESC)WHERE ROWNUM <= 6
mainSelectTwo=SELECT ROWNUM, RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT , QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS FROM( SELECT ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS  FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, PR.PROGRESS  FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO) WHERE P.PRODUCT_TYPE IS NULL AND A.FILE_TYPE='F2' AND P.STATUS = 'Y')  ORDER BY PRO_DATE DESC) WHERE ROWNUM <= 6
insertProduct=INSERT INTO PRODUCT VALUES(PRODUCT_NO.NEXTVAL, ?, ?, ?, 'N')
getProductNo=SELECT PRODUCT_NO.CURRVAL FROM DUAL
insertProDetail=INSERT INTO PRODUCT_DETAIL VALUES(PRO_DETAIL_NO.NEXTVAL, ?, ?, ?, SYSDATE, TO_DATE(?), ?, ?, 0)
getProDetailNo=SELECT PRO_DETAIL_NO.CURRVAL FROM DUAL
insertProRecord=INSERT INTO PRODUCT_RECORD VALUES(PRO_RECORD_NO.NEXTVAL, ?, 'PR1', SYSDATE)
selectFundingListAll=SELECT RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS FROM (SELECT ROWNUM AS R, ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS, STATUS FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, PR.PROGRESS, P.STATUS FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO)WHERE P.PRODUCT_TYPE IS NULL AND A.FILE_TYPE='F2' ORDER BY PRO_DATE) WHERE STATUS ='Y' AND PROGRESS LIKE ? )WHERE R <=4
selectFundFourListAll=SELECT RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS FROM (SELECT ROWNUM AS R, ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, STATUS, PROGRESS FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, P.STATUS, PR.PROGRESS FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO)WHERE P.PRODUCT_TYPE IS NULL AND A.FILE_TYPE='F2' ORDER BY PRO_DATE) WHERE STATUS ='Y' AND PROGRESS LIKE ?)WHERE R >? AND R<=?
selectFundingListOne=SELECT RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS  FROM (SELECT ROWNUM AS R, ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME  , PROGRESS FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, PR.PROGRESS FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO)WHERE P.PRODUCT_TYPE IS NULL AND P.CATEGORY =? AND A.FILE_TYPE='F2' AND PR.PROGRESS LIKE ? AND P.STATUS = 'Y' ORDER BY PRO_DATE ) )WHERE R <=4
selectFundFourListOne=SELECT RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS FROM (SELECT ROWNUM AS R, ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME , PR.PROGRESS FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO)WHERE P.PRODUCT_TYPE IS NULL AND P.CATEGORY =? AND A.FILE_TYPE='F2' AND PR.PROGRESS LIKE ? AND P.STATUS = 'Y' ORDER BY PRO_DATE) ) WHERE ?<R AND R<=?
selectAllFunding=SELECT ROUND((PRO_QTY/PRO_COUNT),2)*100 as RANKS, D.PRO_DETAIL_NO, D.PRODUCT_NO, D.PRO_NAME, P.CATEGORY, D.PRO_DATE, D.PRO_DEADLINE, D.PRO_PRICE, D.PRO_COUNT, D.PRO_QTY, P.FUNDING_TYPE, R.RECORD_DATE, R.PROGRESS, MEMBER_NO FROM PRODUCT_DETAIL D JOIN PRODUCT P ON (D.PRODUCT_NO = P.PRODUCT_NO) JOIN PRODUCT_RECORD R ON (D.PRO_DETAIL_NO = R.PRO_DETAIL_NO) WHERE (PRO_NAME, RECORD_DATE) IN(SELECT PRO_NAME, MAX(RECORD_DATE) FROM PRODUCT_DETAIL JOIN PRODUCT_RECORD USING(PRO_DETAIL_NO) GROUP BY PRO_NAME) AND P.FUNDING_TYPE IN('P2', 'P3') AND P.STATUS = 'Y' AND MEMBER_NO = ?
selectAllProduct=SELECT ROUND((PRO_QTY/PRO_COUNT),2)*100 as RANKS, D.PRO_DETAIL_NO, D.PRODUCT_NO, D.PRO_NAME, P.CATEGORY, D.PRO_DATE, D.PRO_DEADLINE, D.PRO_PRICE, D.PRO_COUNT, D.PRO_QTY, P.FUNDING_TYPE, R.RECORD_DATE, R.PROGRESS, MEMBER_NO FROM PRODUCT_DETAIL D JOIN PRODUCT P ON (D.PRODUCT_NO = P.PRODUCT_NO) JOIN PRODUCT_RECORD R ON (D.PRO_DETAIL_NO = R.PRO_DETAIL_NO) WHERE (PRO_NAME, RECORD_DATE) IN(SELECT PRO_NAME, MAX(RECORD_DATE) FROM PRODUCT_DETAIL JOIN PRODUCT_RECORD USING(PRO_DETAIL_NO) GROUP BY PRO_NAME) AND P.PRODUCT_TYPE = 'P1' AND P.STATUS = 'Y' AND MEMBER_NO = ?
refundApprove=SELECT M.MEMBER_ID, M.MEMBER_NICK, P.PAY_NO, PR.PAY_DETAIL_NO, P.PRODUCT_COUNT, DD.PRO_NAME, D.PRODUCT_TYPE, D.FUNDING_TYPE, ROUND((PRODUCT_COUNT*PRO_PRICE),2) as PAY_PRICE, PR.ACCEPT_NO, PR.COMPLETE_NO FROM PAYMENT P LEFT JOIN PAYMENT_RECORD PR ON(PR.PAY_NO = P.PAY_NO) LEFT JOIN PRODUCT_DETAIL DD ON(P.PRO_DETAIL_NO = DD.PRO_DETAIL_NO) LEFT JOIN PRODUCT D ON(DD.PRODUCT_NO = D.PRODUCT_NO) LEFT JOIN DELIVERY DL ON(P.PAY_NO = DL.PAY_NO) LEFT JOIN MEMBER M ON(DL.MEMBER_NO = M.MEMBER_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.REFUND_PROG = 'REQ'
recordCheck=SELECT FLOOR((SYSDATE - RECORD_DATE)) CHECKDATE FROM PRODUCT_RECORD JOIN PRODUCT_DETAIL USING(PRO_DETAIL_NO) JOIN PRODUCT USING(PRODUCT_NO) WHERE MEMBER_NO = ? AND PROGRESS = 'PR5' ORDER BY 1 DESC
modifyProduct=SELECT BOARD_NO, BOARD_CONTENT, PRODUCT_NO, PRO_DETAIL_NO, PRO_NAME, PRO_DEADLINE, PRO_PRICE, PRO_COUNT, PRODUCT_TYPE, FUNDING_TYPE, CATEGORY FROM PRODUCT_DETAIL D JOIN PRODUCT USING(PRODUCT_NO) JOIN PRODUCT_RECORD USING(PRO_DETAIL_NO) JOIN BOARD USING(PRO_DETAIL_NO) WHERE (PRO_NAME, RECORD_DATE) IN(SELECT PRO_NAME, MAX(RECORD_DATE) FROM PRODUCT_DETAIL JOIN PRODUCT_RECORD USING(PRO_DETAIL_NO) GROUP BY PRO_NAME) AND PRO_DETAIL_NO = ? AND REF_BOARD = 'R1'
checkAttachFarmArea=SELECT * FROM ATTACH WHERE ORI_FILENAME = ? 
insertAttachFarmArea=INSERT INTO ATTACH(FILE_NO, FILE_TYPE, ORI_FILENAME, FILE_ROUTE, UPlOAD_DATE, STATUS, PRO_DETAIL_NO) VALUES(FILE_NO.NEXTVAL, 'F3', ?, 'COM/KH/SRC/IMAGE', DEFAULT, DEFAULT, 0)
updateAttachFarmNo=UPDATE ATTACH SET PRO_DETAIL_NO = ? WHERE FILE_NO = ?
qtyCheck=SELECT PRO_QTY FROM PRODUCT_DETAIL D WHERE MEMBER_NO = ? AND PRO_DETAIL_NO = ?
insertThumbnail=INSERT INTO ATTACH(FILE_NO, FILE_TYPE, ORI_FILENAME, FILE_ROUTE, UPlOAD_DATE, STATUS, PRO_DETAIL_NO) VALUES(FILE_NO.NEXTVAL, 'F2', ?, 'COM/KH/SRC/IMAGE', DEFAULT, DEFAULT, ?)
updateThumbnail=UPDATE ATTACH SET ORI_FILENAME = ?, UPLOAD_DATE = SYSDATE WHERE PRO_DETAIL_NO = ? AND FILE_TYPE = 'F2'
updateProduct=UPDATE PRODUCT SET PRODUCT_TYPE = ?, FUNDING_TYPE = ?, CATEGORY = ?, STATUS = 'N' WHERE PRODUCT_NO = ?
updateProDetail=UPDATE PRODUCT_DETAIL SET PRO_NAME = ?, PRO_DATE = SYSDATE, PRO_DEADLINE = TO_DATE(?), PRO_PRICE = ?, PRO_COUNT = ? WHERE PRO_DETAIL_NO = ?
deleteProduct=UPDATE PRODUCT SET STATUS = 'A' WHERE PRODUCT_NO = ?
getAppProductNo=SELECT PRODUCT_NO FROM PRODUCT_DETAIL WHERE PRO_DETAIL_NO = ?
progChange=UPDATE PRODUCT_RECORD SET PROGRESS = ?, RECORD_DATE = SYSDATE WHERE PRO_DETAIL_NO = ?
selectFoodingListAll=SELECT RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS, MEMBER_NAME FROM (SELECT ROWNUM AS R, ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS, STATUS, MEMBER_NAME FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, PR.PROGRESS, P.STATUS, M.MEMBER_NAME FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO) JOIN MEMBER M ON(M.MEMBER_NO = PD.MEMBER_NO) WHERE P.FUNDING_TYPE IS NULL AND A.FILE_TYPE='F2' ORDER BY PRO_DATE) WHERE STATUS ='Y' AND PROGRESS = 'PR1')WHERE R <=4
selectFoodFourListAll=SELECT RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS, MEMBER_NAME FROM (SELECT ROWNUM AS R, ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, STATUS, PROGRESS, MEMBER_NAME FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, P.STATUS, PR.PROGRESS, M.MEMBER_NAME FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO) JOIN MEMBER M ON(M.MEMBER_NO = PD.MEMBER_NO)WHERE P.FUNDING_TYPE IS NULL AND A.FILE_TYPE='F2' ORDER BY PRO_DATE) WHERE STATUS ='Y' AND PROGRESS = 'PR1')WHERE R >? AND R<=?
getFundingApprove=SELECT M.FARM_NAME, M.FARM_ADDRESS, M.MEMBER_ID, PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT, PD.PRO_PRICE, PD.PRO_DATE, PD.PRO_DEADLINE, P.PRODUCT_NO, P.PRODUCT_TYPE, P.FUNDING_TYPE, P.CATEGORY, B.BOARD_CONTENT FROM PRODUCT_DETAIL PD JOIN PRODUCT P ON(PD.PRODUCT_NO = P.PRODUCT_NO) JOIN MEMBER M ON(PD.MEMBER_NO = M.MEMBER_NO) JOIN BOARD B ON(PD.PRO_DETAIL_NO = B.PRO_DETAIL_NO) WHERE B.REF_BOARD = 'R1' AND P.STATUS = 'N' AND FUNDING_TYPE IN('P2', 'P3')
getProductApprove=SELECT M.FARM_NAME, M.FARM_ADDRESS, M.MEMBER_ID, PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT, PD.PRO_PRICE, PD.PRO_DATE, PD.PRO_DEADLINE, P.PRODUCT_NO, P.PRODUCT_TYPE, P.FUNDING_TYPE, P.CATEGORY, B.BOARD_CONTENT FROM PRODUCT_DETAIL PD JOIN PRODUCT P ON(PD.PRODUCT_NO = P.PRODUCT_NO) JOIN MEMBER M ON(PD.MEMBER_NO = M.MEMBER_NO) JOIN BOARD B ON(PD.PRO_DETAIL_NO = B.PRO_DETAIL_NO) WHERE B.REF_BOARD = 'R1' AND P.STATUS = 'N' AND PRODUCT_TYPE IN('P1')
productApp=UPDATE PRODUCT SET STATUS = 'Y' WHERE PRODUCT_NO = ?
proRecordUpdate=UPDATE PRODUCT_RECORD SET RECORD_DATE = SYSDATE WHERE PRO_DETAIL_NO = ?
productReject=UPDATE PRODUCT SET STATUS = 'D' WHERE PRODUCT_NO = ?
selectFoodListOne=SELECT RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS, MEMBER_NAME FROM (SELECT ROWNUM AS R, ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME  , PROGRESS, MEMBER_NAME FROM ( SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME, PR.PROGRESS, M.MEMBER_NAME FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO) JOIN MEMBER M ON(M.MEMBER_NO = PD.MEMBER_NO)WHERE P.FUNDING_TYPE IS NULL AND P.CATEGORY =? AND A.FILE_TYPE='F2' AND PR.PROGRESS = 'PR1' AND P.STATUS = 'Y' ORDER BY PRO_DATE ) )WHERE R <=4
selectFoodFourListOne=SELECT RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS ,MEMBER_NAME FROM (SELECT ROWNUM AS R, ROUND((QTY/COUNT),2)*100 as RANKS,PRO_DETAIL_NO ,PRO_NAME, COUNT, QTY, PRO_DATE, PRO_PRICE, ORI_FILENAME, PROGRESS,MEMBER_NAME FROM (  SELECT PD.PRO_DETAIL_NO, PD.PRO_NAME, PD.PRO_COUNT AS COUNT, PD.PRO_QTY AS QTY, PD.PRO_DATE, PD.PRO_PRICE ,A.ORI_FILENAME , PR.PROGRESS, M.MEMBER_NAME FROM PRODUCT P JOIN PRODUCT_DETAIL PD ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN ATTACH A ON(PD.PRO_DETAIL_NO = A.PRO_DETAIL_NO) JOIN PRODUCT_RECORD PR ON(PD.PRO_DETAIL_NO = PR.PRO_DETAIL_NO) JOIN MEMBER M ON(M.MEMBER_NO = PD.MEMBER_NO)WHERE P.FUNDING_TYPE IS NULL AND P.CATEGORY =? AND A.FILE_TYPE='F2' AND PR.PROGRESS = 'PR1' AND P.STATUS ='Y' ORDER BY PRO_DATE) ) WHERE ?<R AND R<=?
getMemberNo=SELECT MEMBER_NO FROM PRODUCT_DETAIL WHERE PRO_DETAIL_NO = ?
getCategoryTotal=SELECT (SELECT ((SELECT COUNT(D.CATEGORY) FROM PAYMENT P JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) JOIN PRODUCT D ON(PD.PRODUCT_NO = D.PRODUCT_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND D.CATEGORY = ?) / (SELECT COUNT(PRO_DETAIL_NO) FROM PAYMENT WHERE PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?))) * 100 FROM DUAL) AS FRUIT, (SELECT ((SELECT COUNT(D.CATEGORY) FROM PAYMENT P JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) JOIN PRODUCT D ON(PD.PRODUCT_NO = D.PRODUCT_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND D.CATEGORY = ?) / (SELECT COUNT(PRO_DETAIL_NO) FROM PAYMENT WHERE PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?))) * 100 FROM DUAL) AS FOOD, (SELECT ((SELECT COUNT(D.CATEGORY) FROM PAYMENT P JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) JOIN PRODUCT D ON(PD.PRODUCT_NO = D.PRODUCT_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND D.CATEGORY = ?) / (SELECT COUNT(PRO_DETAIL_NO) FROM PAYMENT WHERE PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?))) * 100 FROM DUAL) AS SPE, (SELECT ((SELECT COUNT(D.CATEGORY) FROM PAYMENT P JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) JOIN PRODUCT D ON(PD.PRODUCT_NO = D.PRODUCT_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND D.CATEGORY = ?) / (SELECT COUNT(PRO_DETAIL_NO) FROM PAYMENT WHERE PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?))) * 100 FROM DUAL) AS VEGE FROM DUAL
sellerFundingUsedCheck=SELECT COUNT(*) FROM MEMBER M  JOIN PRODUCT_DETAIL PD ON(M.MEMBER_NO = PD.MEMBER_NO)  JOIN PRODUCT P ON(P.PRODUCT_NO = PD.PRODUCT_NO) JOIN PRODUCT_RECORD PR ON(PR.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.FUNDING_TYPE IS NOT NULL AND P.STATUS = 'Y' AND PR.PROGRESS <> 'PR5' AND M.MEMBER_NO = ?
getMonthTotal=SELECT NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/01%') FROM DUAL)), 0) AS JAN, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/02%') FROM DUAL)), 0) AS FEB, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/03%') FROM DUAL)), 0) AS MAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/04%') FROM DUAL)), 0) AS APR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/05%') FROM DUAL)), 0) AS MAY, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/06%') FROM DUAL)), 0) AS JUN, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/07%') FROM DUAL)), 0) AS JUL, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/08%') FROM DUAL)), 0) AS AUG, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/09%') FROM DUAL)), 0) AS SEPT, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/10%') FROM DUAL)), 0) AS OCT, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/11%') FROM DUAL)), 0) AS NOV, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/12%') FROM DUAL)), 0) AS DEC FROM DUAL
getYearTotal=SELECT NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3)-4, '%') FROM DUAL)), 0) AS FOYEAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3)-3, '%') FROM DUAL)), 0) AS THYEAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3)-2, '%') FROM DUAL)), 0) AS TWYEAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3)-1, '%') FROM DUAL)), 0) AS ONYEAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '%') FROM DUAL)), 0) AS TOYEAR FROM DUAL
getCompareMonth=SELECT NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/01%') FROM DUAL)), 0) AS JAN, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/02%') FROM DUAL)), 0) AS FEB, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/03%') FROM DUAL)), 0) AS MAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/04%') FROM DUAL)), 0) AS APR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/05%') FROM DUAL)), 0) AS MAY, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/06%') FROM DUAL)), 0) AS JUN, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/07%') FROM DUAL)), 0) AS JUL, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/08%') FROM DUAL)), 0) AS AUG, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/09%') FROM DUAL)), 0) AS SEPT, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/10%') FROM DUAL)), 0) AS OCT, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/11%') FROM DUAL)), 0) AS NOV, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO = ?) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/12%') FROM DUAL)), 0) AS DEC FROM DUAL UNION SELECT NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '01%') FROM DUAL)), 0) AS JAN, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '02%') FROM DUAL)), 0) AS FEB, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/03%') FROM DUAL)), 0) AS MAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/04%') FROM DUAL)), 0) AS APR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/05%') FROM DUAL)), 0) AS MAY, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/06%') FROM DUAL)), 0) AS JUN, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/07%') FROM DUAL)), 0) AS JUL, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/08%') FROM DUAL)), 0) AS AUG, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/09%') FROM DUAL)), 0) AS SEPT, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/10%') FROM DUAL)), 0) AS OCT, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/11%') FROM DUAL)), 0) AS NOV, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE P.PRO_DETAIL_NO IN(SELECT PRO_DETAIL_NO FROM PRODUCT_DETAIL WHERE MEMBER_NO IN(SELECT MEMBER_NO FROM (SELECT PD.MEMBER_NO, SUM(PRODUCT_COUNT*PRO_PRICE) FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) GROUP BY PD.MEMBER_NO ORDER BY 2 DESC) WHERE ROWNUM = 1)) AND PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/12%') FROM DUAL)), 0) AS DEC FROM DUAL
getAdminCategoryTotal=SELECT FLOOR((SELECT ((SELECT COUNT(D.CATEGORY) FROM PAYMENT P JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) JOIN PRODUCT D ON(PD.PRODUCT_NO = D.PRODUCT_NO) WHERE D.CATEGORY = ?) / (SELECT COUNT(PRO_DETAIL_NO) FROM PAYMENT)) * 100 FROM DUAL)) AS FRUIT, FLOOR((SELECT ((SELECT COUNT(D.CATEGORY) FROM PAYMENT P JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) JOIN PRODUCT D ON(PD.PRODUCT_NO = D.PRODUCT_NO) WHERE D.CATEGORY = ?) / (SELECT COUNT(PRO_DETAIL_NO) FROM PAYMENT)) * 100 FROM DUAL)) AS FOOD, FLOOR((SELECT ((SELECT COUNT(D.CATEGORY) FROM PAYMENT P JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) JOIN PRODUCT D ON(PD.PRODUCT_NO = D.PRODUCT_NO) WHERE D.CATEGORY = ?) / (SELECT COUNT(PRO_DETAIL_NO) FROM PAYMENT)) * 100 FROM DUAL)) AS SPE, FLOOR((SELECT ((SELECT COUNT(D.CATEGORY) FROM PAYMENT P JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) JOIN PRODUCT D ON(PD.PRODUCT_NO = D.PRODUCT_NO) WHERE D.CATEGORY = ?) / (SELECT COUNT(PRO_DETAIL_NO) FROM PAYMENT)) * 100 FROM DUAL)) AS VEGE FROM DUAL
getAdminMonthTotal=SELECT NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/01%') FROM DUAL)), 0) AS JAN, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/02%') FROM DUAL)), 0) AS FEB, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/03%') FROM DUAL)), 0) AS MAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/04%') FROM DUAL)), 0) AS APR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/05%') FROM DUAL)), 0) AS MAY, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/06%') FROM DUAL)), 0) AS JUN, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/07%') FROM DUAL)), 0) AS JUL, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/08%') FROM DUAL)), 0) AS AUG, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/09%') FROM DUAL)), 0) AS sept, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/10%') FROM DUAL)), 0) AS OCT, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/11%') FROM DUAL)), 0) AS NOV, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '/12%') FROM DUAL)), 0) AS DEC FROM DUAL
getAdminYearTotal=SELECT NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3)-4, '%') FROM DUAL)), 0) AS FOYEAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3)-3, '%') FROM DUAL)), 0) AS THYEAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3)-2, '%') FROM DUAL)), 0) AS TWYEAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3)-1, '%') FROM DUAL)), 0) AS ONYEAR, NVL((SELECT SUM(PD.PRO_PRICE * P.PRODUCT_COUNT) AS PAY_PRICE FROM PAYMENT P JOIN PAYMENT_RECORD PR ON(P.PAY_NO = PR.PAY_NO) JOIN PRODUCT_DETAIL PD ON(P.PRO_DETAIL_NO = PD.PRO_DETAIL_NO) WHERE PR.PAY_DATE LIKE (SELECT CONCAT(SUBSTR(EXTRACT(YEAR FROM SYSDATE), 3), '%') FROM DUAL)), 0) AS TOYEAR FROM DUAL
